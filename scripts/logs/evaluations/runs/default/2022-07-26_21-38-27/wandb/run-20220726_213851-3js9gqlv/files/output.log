
[[36m2022-07-26 21:38:53,212[39m][[34msrc.testing_pipeline[39m][[32mINFO[39m] - Instantiating trainer <pytorch_lightning.Trainer>
[[36m2022-07-26 21:38:55,486[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Using 16bit native Automatic Mixed Precision (AMP)
[[36m2022-07-26 21:38:55,491[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - GPU available: True, used: True
[[36m2022-07-26 21:38:55,491[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - TPU available: False, using: 0 TPU cores
[[36m2022-07-26 21:38:55,491[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - IPU available: False, using: 0 IPUs
[[36m2022-07-26 21:38:55,491[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - HPU available: False, using: 0 HPUs
[[36m2022-07-26 21:38:55,493[39m][[34msrc.testing_pipeline[39m][[32mINFO[39m] - Starting testing!
[[36m2022-07-26 21:39:10,657[39m][[34mpytorch_lightning.utilities.seed[39m][[32mINFO[39m] - Global seed set to 42
[[36m2022-07-26 21:39:10,658[39m][[34mpytorch_lightning.utilities.distributed[39m][[32mINFO[39m] - Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/5
[[36m2022-07-26 21:39:58,622[39m][[34mtorch.distributed.distributed_c10d[39m][[32mINFO[39m] - Added key: store_based_barrier_key:1 to store for rank: 0
[[36m2022-07-26 21:39:58,622[39m][[34mtorch.distributed.distributed_c10d[39m][[32mINFO[39m] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
[[36m2022-07-26 21:39:58,623[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 5 processes
----------------------------------------------------------------------------------------------------
[[36m2022-07-26 21:40:39,902[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Restoring states from the checkpoint path at /home/compu/jh/project/colon_compare/scripts/logs/experiments/runs/default/2022-07-26_17-43-19/checkpoints/epoch_007.ckpt
[[36m2022-07-26 21:40:51,598[39m][[34mpytorch_lightning.accelerators.gpu[39m][[32mINFO[39m] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
[[36m2022-07-26 21:40:55,426[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Loaded model weights from checkpoint at /home/compu/jh/project/colon_compare/scripts/logs/experiments/runs/default/2022-07-26_17-43-19/checkpoints/epoch_007.ckpt



Testing DataLoader 0:   8%|██████████████████▊                                                                                                                                                                                                                                 | 2/26 [00:08<01:39,  4.15s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 2 + 18 + 10 + 10 + 0
In result_2: 12 + 28 + 10 + 10 + 0
In result_3: 22 + 38 + 20 + 10 + 0
True label: 0
Predict label: 0
vote_cnt_0:22
vote_cnt_1:38
vote_cnt_2:20
vote_cnt_3:10
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 8 + 18 + 22 + 20 + 0
In result_3: 18 + 28 + 32 + 20 + 0
True label: 0
Predict label: 0
vote_cnt_0:18
vote_cnt_1:28
vote_cnt_2:32
vote_cnt_3:20
vote_cls:2
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
Testing DataLoader 0:  12%|████████████████████████████▏                                                                                                                                                                                                                       | 3/26 [00:22<03:19,  8.66s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 19 + 11 + 11 + 0
In result_2: 10 + 29 + 11 + 11 + 0
In result_3: 20 + 39 + 21 + 11 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 12 + 18 + 18 + 0
In result_2: 9 + 21 + 19 + 18 + 0
In result_3: 19 + 31 + 29 + 18 + 0
True label: 1
Predict label: 2
vote_cnt_0:19
vote_cnt_1:31
vote_cnt_2:29
vote_cnt_3:18
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
Testing DataLoader 0:  15%|█████████████████████████████████████▌                                                                                                                                                                                                              | 4/26 [00:34<03:35,  9.79s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  19%|██████████████████████████████████████████████▉                                                                                                                                                                                                     | 5/26 [00:42<03:13,  9.22s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 8 + 24 + 16 + 14 + 0
In result_3: 18 + 34 + 26 + 14 + 0
True label: 1
Predict label: 2
vote_cnt_0:18
vote_cnt_1:34
vote_cnt_2:26
vote_cnt_3:14
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 9 + 25 + 15 + 14 + 0
In result_3: 19 + 35 + 25 + 14 + 0
Testing DataLoader 0:  23%|████████████████████████████████████████████████████████▎                                                                                                                                                                                           | 6/26 [00:52<03:11,  9.56s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 13 + 17 + 17 + 0
In result_2: 10 + 23 + 17 + 17 + 0
In result_3: 20 + 33 + 27 + 17 + 0
True label: 1
Predict label: 2
vote_cnt_0:20
vote_cnt_1:33
vote_cnt_2:27
vote_cnt_3:17
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 10 + 26 + 14 + 14 + 0
In result_3: 20 + 36 + 24 + 14 + 0
Testing DataLoader 0:  27%|█████████████████████████████████████████████████████████████████▋                                                                                                                                                                                  | 7/26 [01:04<03:13, 10.20s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 12 + 18 + 18 + 0
In result_2: 1 + 13 + 27 + 18 + 0
In result_3: 11 + 23 + 37 + 18 + 0
Testing DataLoader 0:  31%|███████████████████████████████████████████████████████████████████████████                                                                                                                                                                         | 8/26 [01:10<02:43,  9.06s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  35%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                               | 9/26 [01:19<02:29,  8.82s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 11 + 19 + 19 + 0
In result_2: 4 + 15 + 25 + 19 + 0
In result_3: 14 + 25 + 35 + 19 + 0
Testing DataLoader 0:  38%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                     | 10/26 [01:27<02:19,  8.72s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  42%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                            | 11/26 [01:38<02:19,  9.27s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 13 + 17 + 17 + 0
In result_2: 10 + 23 + 17 + 17 + 0
In result_3: 20 + 33 + 27 + 17 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  46%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                  | 12/26 [01:48<02:14,  9.61s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 19 + 11 + 11 + 0
In result_2: 8 + 27 + 13 + 11 + 0
In result_3: 18 + 37 + 23 + 11 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                         | 13/26 [01:58<02:04,  9.61s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  54%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                | 14/26 [02:04<01:43,  8.59s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 11 + 19 + 19 + 0
In result_2: 0 + 11 + 29 + 19 + 0
In result_3: 10 + 21 + 39 + 19 + 0
Testing DataLoader 0:  58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                      | 15/26 [02:14<01:40,  9.10s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0




Testing DataLoader 0:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 20/26 [02:56<00:50,  8.35s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 11 + 19 + 19 + 0
In result_2: 0 + 11 + 29 + 19 + 0
In result_3: 10 + 21 + 39 + 19 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 4 + 14 + 26 + 20 + 0
In result_3: 14 + 24 + 36 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 9 + 25 + 15 + 14 + 0
In result_3: 19 + 35 + 25 + 14 + 0
Testing DataLoader 0:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                              | 21/26 [03:07<00:45,  9.19s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0

Testing DataLoader 0:  88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 23/26 [03:20<00:23,  7.74s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 1 + 11 + 29 + 20 + 0
In result_3: 11 + 21 + 39 + 20 + 0
Testing DataLoader 0:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 24/26 [03:26<00:14,  7.04s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0

Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [03:39<00:00,  8.44s/it]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m        Test metric        [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m   test/cnt_correct_diff   [39m│[35m            8.0            [39m│
│[36m       test/cnt_diff       [39m│[35m           23.0            [39m│
│[36m       test/f1_macro       [39m│[35m    0.6232744455337524     [39m│
│[36m         test/loss         [39m│[35m    0.6044451594352722     [39m│
│[36m       test/new_acc        [39m│[35m    0.8276699185371399     [39m│
│[36m      test/origin_acc      [39m│[35m    0.8281553983688354     [39m│
│[36m       test/wqKappa        [39m│[35m    0.7663960456848145     [39m│
└───────────────────────────┴───────────────────────────┘