[[36m2022-07-26 23:46:31,551[39m][[34msrc.testing_pipeline[39m][[32mINFO[39m] - Instantiating trainer <pytorch_lightning.Trainer>
[[36m2022-07-26 23:46:35,903[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Using 16bit native Automatic Mixed Precision (AMP)
[[36m2022-07-26 23:46:35,906[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - GPU available: True, used: True
[[36m2022-07-26 23:46:35,907[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - TPU available: False, using: 0 TPU cores
[[36m2022-07-26 23:46:35,907[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - IPU available: False, using: 0 IPUs
[[36m2022-07-26 23:46:35,907[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - HPU available: False, using: 0 HPUs
[[36m2022-07-26 23:46:35,908[39m][[34msrc.testing_pipeline[39m][[32mINFO[39m] - Starting testing!
[[36m2022-07-26 23:46:51,040[39m][[34mpytorch_lightning.utilities.seed[39m][[32mINFO[39m] - Global seed set to 42
[[36m2022-07-26 23:46:51,043[39m][[34mpytorch_lightning.utilities.distributed[39m][[32mINFO[39m] - Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/5
[[36m2022-07-26 23:47:37,404[39m][[34mtorch.distributed.distributed_c10d[39m][[32mINFO[39m] - Added key: store_based_barrier_key:1 to store for rank: 0
[[36m2022-07-26 23:47:37,407[39m][[34mtorch.distributed.distributed_c10d[39m][[32mINFO[39m] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
[[36m2022-07-26 23:47:37,408[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 5 processes
----------------------------------------------------------------------------------------------------
[[36m2022-07-26 23:48:17,208[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Restoring states from the checkpoint path at /home/compu/jh/project/colon_compare/scripts/logs/experiments/runs/default/2022-07-26_17-43-19/checkpoints/epoch_007.ckpt
[[36m2022-07-26 23:48:28,985[39m][[34mpytorch_lightning.accelerators.gpu[39m][[32mINFO[39m] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
[[36m2022-07-26 23:48:31,749[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Loaded model weights from checkpoint at /home/compu/jh/project/colon_compare/scripts/logs/experiments/runs/default/2022-07-26_17-43-19/checkpoints/epoch_007.ckpt



Testing DataLoader 0:   8%|██████████████████▊                                                                                                                                                                                                                                 | 2/26 [00:10<01:59,  4.98s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 2 + 18 + 10 + 10 + 0
In result_2: 12 + 28 + 10 + 10 + 0
In result_3: 22 + 38 + 20 + 10 + 0
True label: 0
Predict label: 0
vote_cnt_0:22
vote_cnt_1:38
vote_cnt_2:20
vote_cnt_3:10
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 8 + 18 + 22 + 20 + 0
In result_3: 18 + 28 + 32 + 20 + 0
True label: 0
Predict label: 0
vote_cnt_0:18
vote_cnt_1:28
vote_cnt_2:32
vote_cnt_3:20
vote_cls:2
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
Testing DataLoader 0:  12%|████████████████████████████▏                                                                                                                                                                                                                       | 3/26 [00:24<03:27,  9.01s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 19 + 11 + 11 + 0
In result_2: 10 + 29 + 11 + 11 + 0
In result_3: 20 + 39 + 21 + 11 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 12 + 18 + 18 + 0
In result_2: 9 + 21 + 19 + 18 + 0
In result_3: 19 + 31 + 29 + 18 + 0
True label: 1
Predict label: 2
vote_cnt_0:19
vote_cnt_1:31
vote_cnt_2:29
vote_cnt_3:18
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
Testing DataLoader 0:  15%|█████████████████████████████████████▌                                                                                                                                                                                                              | 4/26 [00:35<03:37,  9.89s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  19%|██████████████████████████████████████████████▉                                                                                                                                                                                                     | 5/26 [00:43<03:13,  9.21s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 8 + 24 + 16 + 14 + 0
In result_3: 18 + 34 + 26 + 14 + 0
True label: 1
Predict label: 2
vote_cnt_0:18
vote_cnt_1:34
vote_cnt_2:26
vote_cnt_3:14
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 9 + 25 + 15 + 14 + 0
In result_3: 19 + 35 + 25 + 14 + 0
Testing DataLoader 0:  23%|████████████████████████████████████████████████████████▎                                                                                                                                                                                           | 6/26 [00:51<02:55,  8.77s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 13 + 17 + 17 + 0
In result_2: 10 + 23 + 17 + 17 + 0
In result_3: 20 + 33 + 27 + 17 + 0
True label: 1
Predict label: 2
vote_cnt_0:20
vote_cnt_1:33
vote_cnt_2:27
vote_cnt_3:17
vote_cls:1
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 10 + 26 + 14 + 14 + 0
In result_3: 20 + 36 + 24 + 14 + 0
Testing DataLoader 0:  27%|█████████████████████████████████████████████████████████████████▋                                                                                                                                                                                  | 7/26 [01:02<03:00,  9.49s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 12 + 18 + 18 + 0
In result_2: 1 + 13 + 27 + 18 + 0
In result_3: 11 + 23 + 37 + 18 + 0
Testing DataLoader 0:  31%|███████████████████████████████████████████████████████████████████████████                                                                                                                                                                         | 8/26 [01:06<02:22,  7.90s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  35%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                               | 9/26 [01:14<02:11,  7.75s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 11 + 19 + 19 + 0
In result_2: 4 + 15 + 25 + 19 + 0
In result_3: 14 + 25 + 35 + 19 + 0
Testing DataLoader 0:  38%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                     | 10/26 [01:22<02:07,  7.97s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  42%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                            | 11/26 [01:31<02:04,  8.30s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 13 + 17 + 17 + 0
In result_2: 10 + 23 + 17 + 17 + 0
In result_3: 20 + 33 + 27 + 17 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  46%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                  | 12/26 [01:43<02:09,  9.27s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 19 + 11 + 11 + 0
In result_2: 8 + 27 + 13 + 11 + 0
In result_3: 18 + 37 + 23 + 11 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                         | 13/26 [01:53<02:02,  9.43s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0
Testing DataLoader 0:  54%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                | 14/26 [02:01<01:48,  9.04s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 11 + 19 + 19 + 0
In result_2: 0 + 11 + 29 + 19 + 0
In result_3: 10 + 21 + 39 + 19 + 0
Testing DataLoader 0:  58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                      | 15/26 [02:08<01:32,  8.42s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0




Testing DataLoader 0:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 20/26 [02:44<00:43,  7.27s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 11 + 19 + 19 + 0
In result_2: 0 + 11 + 29 + 19 + 0
In result_3: 10 + 21 + 39 + 19 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 4 + 14 + 26 + 20 + 0
In result_3: 14 + 24 + 36 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 16 + 14 + 14 + 0
In result_2: 9 + 25 + 15 + 14 + 0
In result_3: 19 + 35 + 25 + 14 + 0
Testing DataLoader 0:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                              | 21/26 [02:55<00:41,  8.28s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0

Testing DataLoader 0:  88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 23/26 [03:10<00:23,  7.73s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 1 + 11 + 29 + 20 + 0
In result_3: 11 + 21 + 39 + 20 + 0
Testing DataLoader 0:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 24/26 [03:17<00:15,  7.73s/it]In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 10 + 20 + 20 + 0
In result_2: 0 + 10 + 30 + 20 + 0
In result_3: 10 + 20 + 40 + 20 + 0
In result_0: 0 + 10 + 10 + 10 + 0
In result_1: 0 + 20 + 10 + 10 + 0
In result_2: 10 + 30 + 10 + 10 + 0
In result_3: 20 + 40 + 20 + 10 + 0

Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [03:34<00:00,  8.24s/it]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m        Test metric        [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m   test/cnt_correct_diff   [39m│[35m            4.0            [39m│
│[36m       test/cnt_diff       [39m│[35m           11.0            [39m│
│[36m       test/f1_macro       [39m│[35m    0.6220071315765381     [39m│
│[36m         test/loss         [39m│[35m    0.6044451594352722     [39m│
│[36m       test/new_acc        [39m│[35m    0.8281553983688354     [39m│
│[36m      test/origin_acc      [39m│[35m    0.8281553983688354     [39m│
│[36m       test/wqKappa        [39m│[35m    0.7628908157348633     [39m│
└───────────────────────────┴───────────────────────────┘